FROM node:10.16.0-alpine AS api
COPY source/. src/
WORKDIR /src
ENV MEMORY 2048
ENV DICOM_REQUEST_HOSTNAME="arc"
ENV DICOM_REQUEST_PORT="8443"
ENV DICOM_AUTHENTICATION_HOST="keycloak"
ENV DICOM_AUTHENTICATION_PORT="8843"
ENV DICOM_SECRET="f80e6642-0613-4b81-a5fd-5b2d7eb61c3f"
ENV AETS_NAME="DCM4CHEE"
ENV API_PORT="8080"
ENV NODE_TLS_REJECT_UNAUTHORIZED=0
CMD node --max-old-space-size=$MEMORY --optimize-for-size app.js
